# 龙芯杯AmberCPU设计报告

<center>中国科学技术大学Amber队</center>

<center>常文正、刘睿博、于硕、闫泽轩</center>

## 设计简介

我们设计的 CPU 采用顺序双发射九级流水，实现了 67 条指令、26 种 CSR 寄存器、16 种例外[^0]。采用 AXI-4 总线。使用 2 路组相联 8KB icache 和 2 路组相联 8KB dcache，采用写回、按写分配的设计，同时两个cache中都采取了 8 路全相连 1KB victim cache用于优化缓存失效带来的性能损失。并使用分支预测器以减少分支失败带来的性能损失。

### 设计变更说明（可选）

本小节仅用于决赛阶段提交设计相对于预赛阶段提交设计有变更的情况。

请说明设计变更意图，并逐条简要列出设计变更内容，最终说明变更所达到的效果。

## 二、设计方案


### （一）总体设计思路

>阐明总体设计思路，即从系统顶层角度出发，概要性地描述整个系统的工作机制，所需要进行哪些设计、完成哪些功能。如果设计比较复杂，那么最好进行模块划分，把每个模块功能和接口的大致情况描述一下。

我们具体设计的cpu基于LoongArch32位精简版参考手册[^0]，参考了姚永斌老师的《超标量处理器设计》[^1]、汪文祥老师的《计算机体系结构基础》[^4]、汪文祥老师和刑金璋老师的《CPU设计实战》[^3]等书籍,并参考了开源项目clap[^2]的译码器实现。



### （二）XX模块设计（可选）

>对模块内部设计方案进行更进一步描述。可以包含：模块的功能意图，模块的输入输出，模块内部的数据通路和控制逻辑，以及可能的软硬件交互机制。

### （三）XX模块设计（可选）

……

 

## 三、设计结果

请不要大篇幅地直接粘贴代码。

### （一）设计交付物说明

说明所提交设计的目录层次，各目录下对应的内容是什么。提供所提交设计进行仿真、综合、上板演示的必要操作提示步骤。

### （二）设计演示结果

以文字、图、表等形式展示设计的演示结果。

## 四、参考设计说明

我们的AmberCPU中绝大多数设计都是完全自主完成的，但是也有一些设计参考了其他开源项目，这里列出了我们参考的开源项目：
| 项目名称 | 项目地址 | 说明 |
| -------- | -------- | ---- |
| [clap][^2] |https://github.com/npz7yyk/clap| 参考译码器的实现 |


## 五、参考文献

[^0]: 龙芯中科技术股份有限公司 芯片研发部. *龙芯架构 32 位精简版参考手册*[S/OL]. 北京: 龙芯中科技术股份有限公司. 2023, v1.03. https://www.loongson.cn/FileShow

[^1]: 姚永斌. *超标量处理器设计*[M]. 北京: 清华大学出版社. 2014.
[^3]: 汪文祥 and 刑金璋. *CPU 设计实战*[M]. 北京: 机械工业出版社. 2021.
[^4]: 胡伟武. *计算机体系结构基础*[M]. 北京: 机械工业出版社. 2021, ed. 3.
[^2]: npz7yyk. *clap* [CP/OL]. GitHub. 2022 (20220814). https://github.com/npz7yyk/clap 